<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
		      <html>
		    <head>
		    <title>ProVerif: process</title>
		    <link rel="stylesheet" href="cssproverif.css">
									   </head>
									 <body>
									 <H1>Process</H1>
<a name=occ1 class="occ">{1}</a> <span class="keyword">new</span> <span class="name">seed</span>: <span class="type">srand</span>;<br>
<a name=occ2 class="occ">{2}</a> <span class="keyword">let</span> <span class="var">px_j</span>: <span class="type">X</span> = <span class="fun">gpkey</span>(<span class="name">seed</span>) <span class="keyword">in</span><br>
<a name=occ3 class="occ">{3}</a> <span class="keyword">let</span> <span class="var">ps_j</span>: <span class="type">S</span> = <span class="fun">gskey</span>(<span class="name">seed</span>) <span class="keyword">in</span><br>
<a name=occ4 class="occ">{4}</a> <span class="keyword">let</span> <span class="var">pTx_j</span>: <span class="type">X</span> = <span class="fun">discheb</span>(<span class="var">px_j</span>,<span class="var">ps_j</span>) <span class="keyword">in</span><br>
<a name=occ5 class="occ">{5}</a> <span class="keyword">out</span>(<span class="name">cc</span>, <span class="fun"></span>(<span class="name">SID_j</span>,<span class="var">px_j</span>,<span class="var">pTx_j</span>));<br>
<a name=occ6 class="occ">{6}</a> <span class="keyword">new</span> <span class="name">Ur_i</span>: <span class="type">nonce</span>;<br>
<a name=occ7 class="occ">{7}</a> <span class="keyword">let</span> <span class="var">HID_i</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat5</span>(<span class="name">ID_i</span>,<span class="fun">bhash</span>(<span class="name">Bio_i</span>))) <span class="keyword">in</span><br>
<a name=occ8 class="occ">{8}</a> <span class="keyword">let</span> <span class="var">HHID_i</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">HID_i</span>,<span class="var">ps_j</span>)) <span class="keyword">in</span><br>
<a name=occ9 class="occ">{9}</a> <span class="keyword">let</span> <span class="var">UID_i</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat4</span>(<span class="var">HID_i</span>,<span class="name">Ur_i</span>)) <span class="keyword">in</span><br>
<a name=occ10 class="occ">{10}</a> <span class="keyword">insert</span> <span class="fun">verif</span>(<span class="var">HID_i</span>,<span class="var">UID_i</span>);<br>
(<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ11 class="occ">{11}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ12 class="occ">{12}</a> <span class="keyword">let</span> <span class="var">b_i</span>: <span class="type">bitstring</span> = <span class="fun">bhash</span>(<span class="name">Bio_i</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ13 class="occ">{13}</a> <span class="keyword">new</span> <span class="name">R_i</span>: <span class="type">nonce</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ14 class="occ">{14}</a> <span class="keyword">let</span> <span class="var">C_i</span>: <span class="type">bitstring</span> = <span class="fun">xor</span>(<span class="name">R_i</span>,<span class="fun">hash</span>(<span class="fun">concat2</span>(<span class="name">ID_i</span>,<span class="name">PW_i</span>,<span class="var">b_i</span>))) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ15 class="occ">{15}</a> <span class="keyword">let</span> <span class="var">V_i</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat3</span>(<span class="name">ID_i</span>,<span class="name">PW_i</span>,<span class="var">b_i</span>,<span class="name">R_i</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ16 class="occ">{16}</a> <span class="keyword">let</span> <span class="var">HID_i_27</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat5</span>(<span class="name">ID_i</span>,<span class="var">b_i</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ17 class="occ">{17}</a> <span class="keyword">out</span>(<span class="name">ca</span>, <span class="fun"></span>(<span class="var">HID_i_27</span>,<span class="var">C_i</span>,<span class="var">V_i</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ18 class="occ">{18}</a> <span class="keyword">in</span>(<span class="name">ca</span>, <span class="fun"></span>(<span class="var">UID_i_28</span>: <span class="type">bitstring</span>,=<span class="var">C_i</span>,=<span class="var">V_i</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ19 class="occ">{19}</a> <span class="keyword">in</span>(<span class="name">cc</span>, <span class="fun"></span>(<span class="var">SID</span>: <span class="type">identity</span>,<span class="var">px_j_29</span>: <span class="type">X</span>,<span class="var">pTx_j_30</span>: <span class="type">X</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ20 class="occ">{20}</a> <span class="keyword">event</span> <span class="fun">beginSj</span>(<span class="var">SID</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ21 class="occ">{21}</a> <span class="keyword">new</span> <span class="name">r_i</span>: <span class="type">S</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ22 class="occ">{22}</a> <span class="keyword">new</span> <span class="name">RN_31</span>: <span class="type">S</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ23 class="occ">{23}</a> <span class="keyword">let</span> <span class="var">Trx</span>: <span class="type">X</span> = <span class="fun">discheb</span>(<span class="var">px_j_29</span>,<span class="name">r_i</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ24 class="occ">{24}</a> <span class="keyword">let</span> <span class="var">Trsx</span>: <span class="type">bitstring</span> = <span class="fun">mult</span>(<span class="var">HID_i_27</span>,<span class="fun">discheb</span>(<span class="var">pTx_j_30</span>,<span class="name">r_i</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ25 class="occ">{25}</a> <span class="keyword">let</span> <span class="var">Trn1x</span>: <span class="type">bitstring</span> = <span class="fun">cheb</span>(<span class="var">UID_i_28</span>,<span class="name">RN_31</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ26 class="occ">{26}</a> <span class="keyword">let</span> <span class="var">HUID_i</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">UID_i_28</span>,<span class="name">RN_31</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ27 class="occ">{27}</a> <span class="keyword">out</span>(<span class="name">cc</span>, <span class="fun"></span>(<span class="var">SID</span>,<span class="var">Trx</span>,<span class="var">Trsx</span>,<span class="var">Trn1x</span>,<span class="var">HUID_i</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ28 class="occ">{28}</a> <span class="keyword">in</span>(<span class="name">cc</span>, <span class="fun"></span>(<span class="var">Trn2x</span>: <span class="type">bitstring</span>,<span class="var">HHUID_i</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ29 class="occ">{29}</a> <span class="keyword">let</span> <span class="var">RN_2_32</span>: <span class="type">S</span> = <span class="fun">bergamo</span>(<span class="var">Trn2x</span>,<span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">HID_i_27</span>,<span class="name">RN_31</span>))) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ30 class="occ">{30}</a> <span class="keyword">if</span> (<span class="var">HHUID_i</span> <span class="fun">=</span> <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="fun">concat</span>(<span class="var">UID_i_28</span>,<span class="name">RN_31</span>),<span class="var">RN_2_32</span>))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ31 class="occ">{31}</a> <span class="keyword">event</span> <span class="fun">endUi</span>(<span class="var">HID_i_27</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ32 class="occ">{32}</a> <span class="keyword">let</span> <span class="var">sess</span>: <span class="type">bitstring</span> = <span class="fun">cheb</span>(<span class="fun">cheb</span>(<span class="fun">hash</span>(<span class="fun">concat</span>(<span class="fun">concat</span>(<span class="var">HID_i_27</span>,<span class="name">RN_31</span>),<span class="var">RN_2_32</span>)),<span class="name">RN_31</span>),<span class="var">RN_2_32</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ33 class="occ">{33}</a> <span class="keyword">out</span>(<span class="name">cc</span>, <span class="fun">xor</span>(<span class="name">secretU</span>,<span class="var">sess</span>))<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ34 class="occ">{34}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ35 class="occ">{35}</a> <span class="keyword">in</span>(<span class="name">cc</span>, <span class="fun"></span>(=<span class="name">SID_j</span>,<span class="var">Trx_33</span>: <span class="type">X</span>,<span class="var">Trsx_34</span>: <span class="type">bitstring</span>,<span class="var">Trn1x_35</span>: <span class="type">bitstring</span>,<span class="var">HUID_i_36</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ36 class="occ">{36}</a> <span class="keyword">let</span> <span class="var">HID_i_37</span>: <span class="type">bitstring</span> = <span class="fun">div</span>(<span class="var">Trsx_34</span>,<span class="fun">discheb</span>(<span class="var">Trx_33</span>,<span class="var">ps_j</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ37 class="occ">{37}</a> <span class="keyword">event</span> <span class="fun">beginUi</span>(<span class="var">HID_i_37</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ38 class="occ">{38}</a> <span class="keyword">let</span> <span class="var">HHID_i_38</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">HID_i_37</span>,<span class="var">ps_j</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ48 class="occ">{48}</a> <span class="keyword">get</span> <span class="fun">verif</span>(=<span class="var">HHID_i_38</span>,<span class="var">UID_i_39</span>: <span class="type">bitstring</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ39 class="occ">{39}</a> <span class="keyword">let</span> <span class="var">RN_1_40</span>: <span class="type">S</span> = <span class="fun">bergamo</span>(<span class="var">Trn1x_35</span>,<span class="var">UID_i_39</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ40 class="occ">{40}</a> <span class="keyword">if</span> (<span class="var">HUID_i_36</span> <span class="fun">=</span> <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">UID_i_39</span>,<span class="var">RN_1_40</span>))) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ41 class="occ">{41}</a> <span class="keyword">new</span> <span class="name">RN_41</span>: <span class="type">S</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ42 class="occ">{42}</a> <span class="keyword">let</span> <span class="var">Trn2x_42</span>: <span class="type">bitstring</span> = <span class="fun">cheb</span>(<span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">HID_i_37</span>,<span class="var">RN_1_40</span>)),<span class="name">RN_41</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ43 class="occ">{43}</a> <span class="keyword">let</span> <span class="var">HHUID_i_43</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="fun">concat</span>(<span class="var">UID_i_39</span>,<span class="var">RN_1_40</span>),<span class="name">RN_41</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ44 class="occ">{44}</a> <span class="keyword">out</span>(<span class="name">cc</span>, <span class="fun"></span>(<span class="var">Trn2x_42</span>,<span class="var">HHUID_i_43</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ45 class="occ">{45}</a> <span class="keyword">event</span> <span class="fun">endSj</span>(<span class="name">SID_j</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ46 class="occ">{46}</a> <span class="keyword">let</span> <span class="var">sess_44</span>: <span class="type">bitstring</span> = <span class="fun">cheb</span>(<span class="fun">cheb</span>(<span class="fun">hash</span>(<span class="fun">concat</span>(<span class="fun">concat</span>(<span class="var">HID_i_37</span>,<span class="var">RN_1_40</span>),<span class="name">RN_41</span>)),<span class="var">RN_1_40</span>),<span class="name">RN_41</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ47 class="occ">{47}</a> <span class="keyword">out</span>(<span class="name">cc</span>, <span class="fun">xor</span>(<span class="name">secretS</span>,<span class="var">sess_44</span>))<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ49 class="occ">{49}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ50 class="occ">{50}</a> <span class="keyword">in</span>(<span class="name">ca</span>, <span class="fun"></span>(<span class="var">HID</span>: <span class="type">bitstring</span>,<span class="var">C</span>: <span class="type">bitstring</span>,<span class="var">V</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ51 class="occ">{51}</a> <span class="keyword">new</span> <span class="name">Ur</span>: <span class="type">nonce</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ52 class="occ">{52}</a> <span class="keyword">let</span> <span class="var">UID</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat4</span>(<span class="var">HID</span>,<span class="name">Ur</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ53 class="occ">{53}</a> <span class="keyword">out</span>(<span class="name">cb</span>, <span class="fun"></span>(<span class="var">HID</span>,<span class="var">UID</span>))<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ54 class="occ">{54}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ55 class="occ">{55}</a> <span class="keyword">in</span>(<span class="name">cb</span>, <span class="fun"></span>(<span class="var">HID_45</span>: <span class="type">bitstring</span>,<span class="var">UID_46</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ56 class="occ">{56}</a> <span class="keyword">let</span> <span class="var">HHID</span>: <span class="type">bitstring</span> = <span class="fun">hash</span>(<span class="fun">concat</span>(<span class="var">HID_45</span>,<span class="var">ps_j</span>)) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ57 class="occ">{57}</a> <span class="keyword">if</span> (<span class="var">HHID</span> <span class="fun">&lt;&gt;</span> <span class="var">HHID_i</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ58 class="occ">{58}</a> <span class="keyword">insert</span> <span class="fun">verif</span>(<span class="var">HHID</span>,<span class="var">UID_46</span>)<br>
)<br>
<br>
</body>
</html>
